<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>SpringBoot注解 | 高士傑</title>

<link rel="shortcut icon" href="https://1958818905.github.io/favicon.ico?v=1600861678269">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://1958818905.github.io/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            高士傑
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1600861678269" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    SpringBoot注解
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2020-09-07 ·
                    </time>
                    
                </div>
                <div class="post-content">
                    <h3 id="springboot注解的优缺点">SpringBoot注解的优缺点</h3>
<ol>
<li>优点
<ul>
<li>快速构建项目。</li>
<li>对主流开发框架的无配置集成。</li>
<li>项目可独立运行，无须外部依赖Servlet容器。</li>
<li>提供运行时的应用监控。</li>
<li>极大的提高了开发、部署效率。</li>
<li>与云计算的天然集成。</li>
</ul>
</li>
<li>缺点：
<ul>
<li>版本迭代速度很快，一些模块改动很大</li>
<li>由于不用自己做配置，报错时很难定位</li>
<li>网上现成的解决方案比较少</li>
</ul>
</li>
</ol>
<h3 id="注解">注解</h3>
<ol>
<li>SpringBootApplication – 主配置类
<ul>
<li>效果：说明这个类就是SpringBoot的主配置类，SpringBoot就应该运行主配置类的main方法执行程序。</li>
</ul>
</li>
</ol>
<pre><code class="language-java">@SpringBootApplication
public class SpringBootMaven {
  public static void main(String[] args) {
      SpringApplication.run(SpringBootMaven.class, args);
  }
}
</code></pre>
<ul>
<li>继承@SpringBootConfiguration、@EnableAutoConfiguration、@ComponentScan</li>
<li>@SpringBootConfiguration：继承@Configuration，Spring配置注解，将当前类声明的一个或多个@Bean注解标记的方法纳入Spring容器，实例名就是方法名.</li>
<li>@EnableAutoConfiguration：继承@AutoConfigurationPackage，<br>
导入了AutoConfigurationImportSelector.class AutoConfigurationPackages.Registrar.class根据添加的jar包来配置项目的默认配置。</li>
<li>@ComponentScan：扫描当前包及其子包下被@Component，@Controller，@Service，</li>
<li>@Repository注解标记的类并纳入到spring容器中进行管理</li>
</ul>
<ol start="2">
<li>EnableAutoConfiguration -自动装配</li>
</ol>
<ul>
<li>效果：借助AutoConfigurationImportSelector.class，为SpringBoot应用将所有符合条件的@Configuration配置都加载到当前SpringBoot创建并使用的IoC容器</li>
</ul>
<pre><code class="language-java">@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)
</code></pre>
<ol start="3">
<li>@RestController – 控制器</li>
</ol>
<ul>
<li>@RestController == @ResponseBody + @Controller</li>
<li>@ResponseBody：标记在类上，表示类下所有方法返回一条语句给网站，@Controller：标记当前类为控制器.</li>
</ul>
<pre><code>@RestController
public class SpringbootiniApplication {
    @RequestMapping(&quot;/&quot;)
    String hello(){
        return &quot;hello world quick&quot;;
    }
}
</code></pre>
<ol start="4">
<li>@ConfigurationProperties – 配置属性绑定</li>
</ol>
<ul>
<li>把全局/主配yml/properties的配置信息注入到POJO（全局 &gt; application.yml/properties）</li>
<li>需要把当前类标记为组件（@Component），添加属性prefix = “xx”，xx为yml里的key</li>
</ul>
<pre><code>@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
public class Person {
    int age;
    String name;
    public int getAge() {
        return age;
    }
    public void setAge(int age) {
        this.age = age;
    }
}

</code></pre>
<ul>
<li>而且根据SpringBoot文档，还需要添加依赖处理器</li>
</ul>
<pre><code>&lt;!-- yml依赖处理器 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>然后重新启动springboot</li>
</ul>
<ol start="5">
<li>@PropertySource – 引入SpringBoot配置</li>
</ol>
<ul>
<li>当@ConfigurationProperties需要从副配置文件拿数据时，可用@PropertySource手动引入副配置，value可指定多个路径</li>
</ul>
<pre><code>@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
@PropertySource(value = {&quot;classpath:person.properties&quot;})
public class Person {
    int age;
    String name;
    public int getAge() {
        return age;
    }
    public void setAge(int age) {
        this.age = age;
    }
}
</code></pre>
<ul>
<li>相同key优先级：全局配置 &gt; 副配置</li>
<li>上面用person.properties而不用person.yml不是没有原因的，yml除了主配，其他配置不生效</li>
</ul>
<ol start="6">
<li>@ImportSource – 引入Spring配置@ImportSource – 引入Spring配置</li>
</ol>
<ul>
<li>在SpringBoot中，引入bean.xml（Spring配置文件），需要在主类配置该注解，可导入多个配置文件</li>
</ul>
<pre><code>@SpringBootApplication
@ImportResource(locations = {&quot;classpath:bean.xml&quot;})
public class SpringbootiniApplication {
    public static void main(String[] args) {
        SpringApplication.run(SpringbootiniApplication.class, args);
    }
}
</code></pre>
<ol start="7">
<li>@Configuration – 注解代替Spring配置</li>
</ol>
<ul>
<li>Spring注解，标记类后当前类成配置类，当前类的@Bean注解即</li>
<li>applicationContext.xml == @Configuration + @Bean + @ComponentSca…</li>
<li>SpringBoot推荐 =&gt; 注解代替配置文件</li>
</ul>
<pre><code>@Configuration
public class MyAppConfig {
    @Bean
    public Student student(){
        System.out.println(&quot;@bean is ok&quot;);
        return new Student();
    }
}
class Student{}
</code></pre>
<ul>
<li>@Bean：将方法返回值添加到容器中；容器中这个组件默认id就是方法名</li>
</ul>
<ol start="8">
<li>@ResponseBody – 文本返回</li>
</ol>
<ul>
<li>标注方法上，如果你有返回值，返回值变文本格式输出，若没有标注，则分发器会走视图解析器，然后报错说/template下找不到视图，如果你只是ajax异步回来处理数据存储，不需要返回页面则无需标注</li>
</ul>
<pre><code>@RequestMapping(&quot;/login&quot;)
　　@ResponseBody
　　public User login(User user){
　　　　return user;
　　}
　　User字段：userName pwd
　　那么在前台接收到的数据为：’{“userName”:“xxx”,“pwd”:“xxx”}’
</code></pre>
<ol start="9">
<li>@Transactional – 事务</li>
</ol>
<ul>
<li>如下有一个保存用户的方法，加入 @Transactional 注解，使用默认配置，抛出异常之后，事务会自动回滚，数据不会插入到数据库。</li>
</ul>
<pre><code>@Transactional
public void save() {
    User user = new User(&quot;服部半藏&quot;);
    userMapper.insertSelective(user);

    if (true) {
        throw new RuntimeException(&quot;save 抛异常了&quot;);
    }
}
</code></pre>
<ol start="10">
<li>@Param – 绑定EL和参数</li>
</ol>
<ul>
<li>mybatis提示类型绑定问题</li>
</ul>
<pre><code>@Select(&quot;select * from myuser where loginname=#{loginname} and password=#{password}&quot;)
User findWithLoginnameAndPassword(@Param(&quot;loginname&quot;)int loginname,
                                  @Param(&quot;password&quot;)String password);
</code></pre>

                </div>
            </article>
        </div>

        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">温故而知新</div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://1958818905.github.io/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
